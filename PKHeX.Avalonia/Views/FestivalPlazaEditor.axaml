<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:PKHeX.Avalonia.ViewModels"
             x:Class="PKHeX.Avalonia.Views.FestivalPlazaEditor"
             x:DataType="vm:FestivalPlazaEditorViewModel">

    <Border Padding="16" Classes="view-container">
        <Panel>
            <!-- Not supported message -->
            <StackPanel VerticalAlignment="Center"
                        HorizontalAlignment="Center"
                        IsVisible="{Binding !IsSupported}">
                <TextBlock Text="Festival Plaza not available"
                           FontSize="18"
                           HorizontalAlignment="Center"
                           Opacity="0.7" />
                <TextBlock Text="This save type does not support Festival Plaza (Gen 7 SM/USUM only)."
                           HorizontalAlignment="Center"
                           Opacity="0.5"
                           Margin="0,8,0,0" />
            </StackPanel>

            <!-- Main content -->
            <DockPanel IsVisible="{Binding IsSupported}">
                <!-- Header -->
                <DockPanel DockPanel.Dock="Top" Margin="0,0,0,12">
                    <TextBlock Text="Festival Plaza Editor" FontSize="20" FontWeight="SemiBold" VerticalAlignment="Center" />
                    <Button Content="Refresh"
                            Command="{Binding RefreshCommand}"
                            HorizontalAlignment="Right"
                            Padding="12,6" />
                </DockPanel>

                <!-- Content -->
                <Grid ColumnDefinitions="*,16,*">
                    <!-- Left: Plaza Stats -->
                    <Border Grid.Column="0"
                            Classes="section-card"
                            CornerRadius="4"
                            Padding="16">
                        <StackPanel Spacing="16">
                            <TextBlock Text="Plaza Info" FontWeight="SemiBold" FontSize="14" />

                            <Grid ColumnDefinitions="Auto,8,*" RowDefinitions="Auto,8,Auto,8,Auto,8,Auto,8,Auto">
                                <TextBlock Grid.Row="0" Grid.Column="0" Text="Plaza Name:" VerticalAlignment="Center" />
                                <TextBox Grid.Row="0" Grid.Column="2" Text="{Binding PlazaName}" />

                                <TextBlock Grid.Row="2" Grid.Column="0" Text="Rank:" VerticalAlignment="Center" />
                                <NumericUpDown Grid.Row="2" Grid.Column="2" Value="{Binding Rank}" Minimum="1" Maximum="999" />

                                <TextBlock Grid.Row="4" Grid.Column="0" Text="FC Range:" VerticalAlignment="Center" />
                                <TextBlock Grid.Row="4" Grid.Column="2" Text="{Binding RankFCRange}" VerticalAlignment="Center" Opacity="0.7" />

                                <TextBlock Grid.Row="6" Grid.Column="0" Text="Current FC:" VerticalAlignment="Center" />
                                <NumericUpDown Grid.Row="6" Grid.Column="2" Value="{Binding CurrentFC}" Minimum="0" Maximum="9999999" />

                                <TextBlock Grid.Row="8" Grid.Column="0" Text="Total FC:" VerticalAlignment="Center" />
                                <TextBlock Grid.Row="8" Grid.Column="2" Text="{Binding TotalFC}" VerticalAlignment="Center" FontWeight="SemiBold" />
                            </Grid>
                        </StackPanel>
                    </Border>

                    <!-- Right: Facilities -->
                    <Border Grid.Column="2"
                            Classes="section-card"
                            CornerRadius="4"
                            Padding="16">
                        <DockPanel>
                            <TextBlock DockPanel.Dock="Top" Text="Facilities" FontWeight="SemiBold" FontSize="14" Margin="0,0,0,12" />

                            <Grid RowDefinitions="*,8,Auto">
                                <ListBox Grid.Row="0"
                                         ItemsSource="{Binding Facilities}"
                                         SelectedItem="{Binding SelectedFacility}">
                                    <ListBox.ItemTemplate>
                                        <DataTemplate DataType="vm:FacilityViewModel">
                                            <StackPanel Orientation="Horizontal" Spacing="8">
                                                <TextBlock Text="{Binding DisplayName}" />
                                                <TextBlock Text="{Binding OwnerName}" Opacity="0.7" />
                                            </StackPanel>
                                        </DataTemplate>
                                    </ListBox.ItemTemplate>
                                </ListBox>

                                <!-- Selected Facility Details -->
                                <Border Grid.Row="2"
                                        Background="{DynamicResource SystemControlBackgroundBaseLowBrush}"
                                        CornerRadius="4"
                                        Padding="12"
                                        IsVisible="{Binding SelectedFacility, Converter={x:Static ObjectConverters.IsNotNull}}">
                                    <Grid ColumnDefinitions="Auto,8,*" RowDefinitions="Auto,8,Auto,8,Auto"
                                          DataContext="{Binding SelectedFacility}">
                                        <TextBlock Grid.Row="0" Grid.Column="0" Text="Owner:" VerticalAlignment="Center" />
                                        <TextBox Grid.Row="0" Grid.Column="2" Text="{Binding OwnerName}" />

                                        <TextBlock Grid.Row="2" Grid.Column="0" Text="Type:" VerticalAlignment="Center" />
                                        <NumericUpDown Grid.Row="2" Grid.Column="2" Value="{Binding Type}" Minimum="0" Maximum="127" />

                                        <TextBlock Grid.Row="4" Grid.Column="0" Text="Color:" VerticalAlignment="Center" />
                                        <NumericUpDown Grid.Row="4" Grid.Column="2" Value="{Binding Color}" Minimum="0" Maximum="7" />
                                    </Grid>
                                </Border>
                            </Grid>
                        </DockPanel>
                    </Border>
                </Grid>
            </DockPanel>
        </Panel>
    </Border>
</UserControl>
